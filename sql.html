<!DOCTYPE html>
<html>
<head>
    <title>SQL 인젝션 데모</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
        .container { max-width: 800px; margin: 0 auto; }
        input, button { padding: 8px; margin: 10px 0; }
        #result { border: 1px solid #ddd; padding: 15px; margin-top: 20px; }
        .vulnerable { color: red; font-weight: bold; }
        .safe { color: green; font-weight: bold; }
        pre { background: #f4f4f4; padding: 10px; overflow: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>SQL 인젝션 데모</h1>
        <p>(극단적 예시)</p>
        
        <h2>취약한 로그인</h2>
        <form id="vulnerableForm">
            <div>
                <label>아이디:</label>
                <input type="text" id="vulnUsername" placeholder="아이디 입력">
            </div>
            <div>
                <label>비밀번호:</label>
                <input type="password" id="vulnPassword" placeholder="비밀번호 입력">
            </div>
            <button type="button" onclick="vulnerableLogin()">로그인</button>
        </form>
        
        <h2>안전한 로그인</h2>
        <form id="safeForm">
            <div>
                <label>아이디:</label>
                <input type="text" id="safeUsername" placeholder="아이디 입력">
            </div>
            <div>
                <label>비밀번호:</label>
                <input type="password" id="safePassword" placeholder="비밀번호 입력">
            </div>
            <button type="button" onclick="safeLogin()">로그인</button>
        </form>
        
        <div id="result">
            <h3>결과</h3>
            <div id="queryResult"></div>
        </div>
        
        <div>
            <h2>시도해볼 SQL 인젝션</h2>
            <pre>' OR '1'='1</pre>
        </div>
    </div>

    <script>
        const users = [
            { id: 1, username: 'admin', password: 'admin123' },
            { id: 2, username: 'dwasd', password: 'dwasdwasd' }
        ];
        
        function vulnerableLogin() {
            const username = document.getElementById('vulnUsername').value;
            const password = document.getElementById('vulnPassword').value;
            
            const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;
            
            let result = "";
            try {
                if (query.includes("' OR '1'='1")) {
                    result = `<div class="vulnerable">공격 성공</div>
                             <p>실행된 쿼리: ${query}</p>
                             <p>모든 사용자 데이터 노출(연출)</p>
                             <pre>${JSON.stringify(users, null, 2)}</pre>`;
                } else {
                    const user = users.find(u => u.username === username && u.password === password);
                    if (user) {
                        result = `<div>로그인 성공</div>
                                 <p>실행된 쿼리: ${query}</p>`;
                    } else {
                        result = `<div>로그인 실패</div>
                                 <p>실행된 쿼리: ${query}</p>
                                 <p>사용자를 찾을 수 없음</p>`;
                    }
                }
            } catch (e) {
                result = `<div>오류 발생: ${e.message}</div>`;
            }
            
            document.getElementById('queryResult').innerHTML = result;
        }
        
        function safeLogin() {
            const username = document.getElementById('safeUsername').value;
            const password = document.getElementById('safePassword').value;
            
            const query = "SELECT * FROM users WHERE username = ? AND password = ?";
            
            let result = "";
            try {
                const user = users.find(u => u.username === username && u.password === password);
                if (user) {
                    result = `<div class="safe">안전한 로그인</div>
                             <p>실행된 쿼리: ${query}</p>
                             <p>바인딩된 매개변수: username="${username}", password="${password}"</p>`;
                } else {
                    result = `<div class="safe">로그인 실패</div>
                             <p>실행된 쿼리: ${query}</p>
                             <p>바인딩된 매개변수: username="${username}", password="${password}"</p>
                             <p>결과: 사용자를 찾을 수 없음</p>`;
                }
            } catch (e) {
                result = `<div>오류 발생: ${e.message}</div>`;
            }
            
            document.getElementById('queryResult').innerHTML = result;
        }
    </script>
</body>

</html>
